# О работе "Большой проект по предобработке и исследовательскому анализу данных. Выяснение того как господдержка влияет на кассовые сборы и рейтинг фильма"

Данный проект содержал меня подробное ТЗ. Я предобработал данные на Pandas. Используя графики и таблицы, корелляцию Пирсона выяснил как господдержка влияет на популярность фильма. Сложность проекта заключалась в обилии строковых столбцов, которые пришлось очищать. Большая часть визуализаций в проекте выполнена с помощью Plotly

Технологии: Python, Pandas, matplotlib, plotly

# Вывод по работе взятый из конца файла .ipynb

## Подключение библиотек и первый взгляд на данные

**Дейстивия с данными**

По столбцу `puNumber` было объединено две таблицы `shows` (3158 строки) и `movies` (7468 строки). В столбце `puNumber` были удалены некорректные значения и сменён тип данных. В итоговой таблице data – 7468 строк и 17 столбцов.

**Наблюдения**  
В таблице есть пропуски и некорректные типы данных.
- В столбцах `refundable_support`, `nonrefundable_support`, `budget`, `financing_source` пропуски составляют более 95% от всех значений. В столбце `box_office` пропусков – 57% от всех значений. В `director`, `producer`, `age_restriction`, `ratings`, `film_studio` пропусков не так много. В остальных столбцах пропусков нет.
- В столбце `show_start_date` лучше перевести данные в формат даты.
- В столбцах, связанных с деньгами (`refundable_support`, `nonrefundable_support`, `budget`, `box_office`), тип данных стоит сменить на целочисленный, так как дробная часть слишком мала, чтобы иметь вес при таких больших числах.
- В столбце `age_restriction` тип данных лучше заменить на числовой, так как это упростит анализ данных (например, "18+ строго" в "18", "16+" в "16" и т.д.).
- В столбце `ratings` тип данных лучше заменить на числовой, так как это упростит анализ данных.
- Распределение числовых данных выглядит правдоподобно.
- Есть неявные дубликаты фильмов с разными `puNumber`.

## Предобработка данных

## Обработка дубликатов
- Явные дубликаты отсутствуют.
- Удалено 714 неявных дубликатов по `puNumber`.

## Смена типов данных
- В `refundable_support`, `nonrefundable_support`, `budget`, `box_office` типы изменены на целочисленные.
- `ratings` и `show_start_date` теперь числовой и датовый соответственно.

## Обработка пропусков
- Удалены строки с пропусками в `film_studio`, `director`, `production_country`.
- Пропуски в `financing_source` заполнены значением "отсутствует".

## Удаление выбросов
- Удалены аномальные значения в `refundable_support`, `nonrefundable_support`, `budget`, `box_office`, `ratings`.

## Преобразование данных
- Применено one-hot кодирование к столбцам `film_studio`, `production_country`, `genres`, `financing_source`.
- В `age_restriction` выполнено сокращение длины строки, в `director` и `producer` — удаление неявных дубликатов и преобразование строки режиссёров и продюсеров в массивы.

## Создание новых столбцов
- Добавлены: `show_start_year`, `main_genre`, `main_director`, `bugdet_gos_support_percent`, `cinema_relised`.

## Исследовательский анализ данных

## Исследование тенденций на рынке кинопроката
- Суммарные сборы фильмов значительно колеблются с 2010 по 2019 год, с резкими изменениями в 2014 и 2015 годах.
- Максимальные сборы в 2017 году — 195.3 млрд, минимальные в 2010 — 2.3 млн.
- Средние сборы фильма растут с 29.5 тыс. в 2010 до 45.4 млн в 2018.
- Медианные сборы варьируются от 2 тыс. в 2010 до 7.5 млн в 2017.
- Рост количества выпущенных фильмов с 739 в 2010 до 835 в 2019, с пиком в 817 в 2018.
- Доля фильмов, вышедших в прокат, растёт с 10% в 2010 до 57% в 2019.

## Исследовательский анализ фильмов с господдержкой
- Коэффициент корреляции между сборами и господдержкой составляет 0.4.
- В большинстве случаев сборы не превышают размер господдержки.
- Фильмы с возрастным ограничением "12+" и "6+" чаще всего оказываются кассовыми.
- Наибольшие общие сборы у фильмов с возрастным ограничением "16+" и "18+".
- Зависимость между рейтингом фильма и размером господдержки отсутствует.
- Министерство культуры чаще поддерживает драмы. Рейтинг слабо зависит от источника финансирования.

## Рекомендации по сбору данных и борьбе с пропусками и дубликатами
- Необходимо учитывать, что бывает несколько версий фильма: режиссерская, театральная и т.п.
- Следует приводить имена и страны к единому виду.
- Для анализа данных о господдержке желательно получить больше строк с фильмами.
- Данные должны быть равномерно распределены по годам. Период 2010-2012 представлен очень слабо, период 2013-2014 – недостаточно полно.
- Система сбора данных должна автоматически переводить все значения в числовой формат, чтобы не допустить появления строк с нечисловыми символами в числовых столбцах (например, "  10").

## Значимые проблемы с данными
- В данных имеется ошибка: суммарные сборы фильмов с 2013 по 2014 год выросли в 128 раз – с 28.8 млн до 36.9 млрд.
- Медианные сборы фильма в прокате варьировались от 2 тыс. в 2010 до 7.5 млн в 2017 году. Отмечается резкий рост медианных сборов с 2013 по 2014 год (более чем в 6 раз) и рост более чем в 100 раз с 2014 по 2015 год.





# ТЗ

Теперь самое время проверить знания и решить аналитический кейс. Выполнять работу вы будете самостоятельно.

Когда закончите, отправьте работу на проверку ревьюеру. В течение суток вы получите комментарии, которые нужно учесть: доработать проект и вернуть ревьюеру обновлённый вариант. Возможно, вы будете дорабатывать кейс по комментариям несколько раз. Не переживайте, это нормально.

**Проект завершён, когда одобрены все доработки.**

---

## Описание проекта

Заказчик исследования — **Министерство культуры Российской Федерации**.

Вам необходимо:
- Изучить рынок российского кинопроката и выявить текущие тренды.
- Уделить внимание фильмам, получившим государственную поддержку.
- Попробовать ответить на вопрос: насколько такие фильмы интересны зрителю.

Вы будете работать с данными, опубликованными на портале открытых данных Министерства культуры. Набор данных содержит информацию о:
- Прокатных удостоверениях,
- Сборах и государственной поддержке фильмов,
- Данных с сайта КиноПоиск.

---

## Инструкция по выполнению

### Шаг 1. Открытие и объединение данных

1. Откройте файлы с данными.
2. Объедините данные так, чтобы все объекты из датасета `mkrf_movies` обязательно вошли в итоговый датафрейм.

**Пути к файлам:**
- `/datasets/mkrf_movies.csv` — данные о прокатных удостоверениях.  
  [Скачать датасет]
- `/datasets/mkrf_shows.csv` — данные о прокате в российских кинотеатрах.  
  [Скачать датасет]

### Шаг 2. Предобработка данных

1. **Проверка типов данных**  
   Проверьте типы данных в датафрейме и преобразуйте их, где это необходимо.

2. **Обработка пропусков**  
   - Изучите пропуски в датафрейме.
   - Объясните, почему были заполнены пропуски определённым образом или почему вы не стали этого делать.

3. **Обработка дубликатов**  
   - Проверьте наличие дубликатов.
   - Опишите возможные причины их появления.

4. **Работа с категориальными данными**  
   - Изучите столбцы, содержащие категориальные значения.
   - Определите общую проблему, встречающуюся почти во всех категориальных столбцах.
   - Исправьте проблемные значения в поле `type`.

5. **Анализ количественных данных**  
   - Проверьте столбцы с количественными значениями на предмет подозрительных данных.
   - Опишите, как лучше поступить с такими данными.

6. **Добавление новых столбцов**  
   - **Год проката:** Создайте столбец, выделив год из даты премьеры фильма.
   - **Режиссёр и жанр:** Создайте два столбца — с именем и фамилией главного режиссёра, а также с основным жанром фильма (включите первые значения из списка режиссёров и жанров соответственно).
   - **Доля государственной поддержки:** Посчитайте, какую долю от общего бюджета фильма составляет государственная поддержка.

### Шаг 3. Исследовательский анализ данных

1. **Анализ количества фильмов по годам:**
   - Определите, сколько фильмов выходило в прокат каждый год.
   - Учтите, что данные о прокате в кинотеатрах отсутствуют для некоторых фильмов.
   - Посчитайте долю фильмов с указанной информацией о прокате и проанализируйте, как эта доля менялась по годам.
   - Сделайте вывод о том, какой период представлен полнее всего.

2. **Динамика проката:**
   - Проанализируйте, как менялась динамика проката по годам.
   - Определите год с минимальной и максимальной суммой сборов.

3. **Сводная таблица сборов:**
   - С помощью сводной таблицы посчитайте среднюю и медианную сумму сборов для каждого года.
   - Сравните значения и сделайте выводы.

4. **Влияние возрастного ограничения:**
   - Исследуйте, влияет ли возрастное ограничение аудитории (например, «6+», «12+», «16+», «18+» и т. д.) на сборы фильма в период с 2015 по 2019 год.
   - Определите, фильмы с каким возрастным ограничением собрали больше всего денег.
   - Проверьте, меняется ли картина в зависимости от года и предположите возможные причины изменений.

### Шаг 4. Исследование фильмов с государственной поддержкой

- На этом этапе конкретных инструкций нет.
- **Задачи:**
  - Изучите закономерности в данных.
  - Определите, сколько средств выделяется на поддержку кино.
  - Проверьте, насколько хорошо окупаются такие фильмы и какой у них рейтинг.

### Шаг 5. Общий вывод

- Сформулируйте общий вывод по проделанному анализу.

---

## Оформление проекта

- **Среда выполнения:** Jupyter Notebook.
- **Структура работы:**
  - Программный код — в ячейках типа `code`.
  - Текстовые пояснения — в ячейках типа `markdown`.
  - Используйте форматирование и заголовки для удобства восприятия.

---

## Описание данных

### Таблица `mkrf_movies`
Содержит информацию из реестра прокатных удостоверений. У одного фильма может быть несколько удостоверений.

**Столбцы:**
- **title** — название фильма.
- **puNumber** — номер прокатного удостоверения.
- **show_start_date** — дата премьеры фильма.
- **type** — тип фильма.
- **film_studio** — студия-производитель.
- **production_country** — страна-производитель.
- **director** — режиссёр.
- **producer** — продюсер.
- **age_restriction** — возрастная категория.
- **refundable_support** — объём возвратных средств государственной поддержки.
- **nonrefundable_support** — объём невозвратных средств государственной поддержки.
- **financing_source** — источник государственного финансирования.
- **budget** — общий бюджет фильма (включает полный объём государственной поддержки; данные указаны только для фильмов, получивших поддержку).
- **ratings** — рейтинг фильма на КиноПоиске.
- **genres** — жанр фильма.

### Таблица `mkrf_shows`
Содержит сведения о показах фильмов в российских кинотеатрах.

**Столбцы:**
- **puNumber** — номер прокатного удостоверения.
- **box_office** — сборы в рублях.

---

## Критерии оценки проекта

- **Анализ данных:** Описание найденных проблем и методов их решения (замена типов, обработка пропусков и дубликатов).
- **Автоматизация:** Использование автоматизированных подходов для однотипных действий.
- **Выводы:** Представление итоговых данных в сводных таблицах.
- **Визуализация:** Применение методов построения графиков.
- **Структура кода:** Соблюдение структуры проекта и аккуратность кода.
- **Комментарии:** Наличие пояснений к каждому шагу анализа.

---

Успехов в выполнении проекта!

# Технические комментарии
- Версия с опциональной критикой без правок. Сделал лишь так, чтобы тетрадь запускалась и удалил ненужные библиотеке
- Ruby